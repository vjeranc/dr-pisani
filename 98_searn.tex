\textsc{Searn}

\begin{algorithm}
\caption{Učenje + Pretraživanje (\textsc{Searn})}\label{alg:searn}
\begin{algorithmic}[1]
\Require Skup podataka $\{x_i, y_i\}_{i=1}^N$ uzet iz distribucije $\mathcal{D}$,
  $\beta \geq 0$. %% -- parametar mješavine polica.
\State Inicijaliziraj policu $\hat{\pi}_0 = \pi\ssymbol{1}$.
\ForAll{$I \in \big[0,1,2,\ldots,P)$}
  \ForAll{$i \in \{1,2,\ldots,N\}$}
    \State Inicijaliziraj $\Gamma = \emptyset$. \Comment{skup primjera osjetljivih na trošak.}
    \ForAll{$t \in \{0,1,2,\ldots,T_i-1\}$}
      \State Primijeniti $t$ puta policu $\pi^{\text{in}} = \hat{\pi}_{I}$  i stići do $s_t$. \Comment{Rollin.}
      \ForAll{$a \in A(s_t)$}
        \State Neka je  $\pi^{\text{out}} = \hat{\pi}_{I}$.
        \State Procjeni trošak $c_{i,t}(a)$ koristeći $T-t-1$ puta policu $\pi^{\text{out}}$. \Comment{Rollout.}
      \EndFor
      \State Generiraj vektor značajki $\mathbf{\Phi}(x_i, s_t)$.
      \State Postavi $\Gamma = \Gamma \cup \{\langle c_{i,t}, \mathbf{\Phi}(x_i, s_t) \rangle\}$.
    \EndFor
  \EndFor
  \State $\hat{\pi}' \gets \textsc{Train}(\Gamma)$.
  \State $\hat{\pi}_{I+1} \gets \beta \hat{\pi}' + (1-\beta) \hat{\pi}_{I}$.
\EndFor
\State \Return $\hat{\pi}_{P}$ bez $\pi\ssymbol{1}$
\end{algorithmic}
\end{algorithm}
